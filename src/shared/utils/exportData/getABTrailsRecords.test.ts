import { getABTrailsRecords } from './getABTrailsRecords';

const abTrailLines = [
  {
    points: [
      {
        x: 60,
        y: 136,
        time: 1689928710571,
        valid: true,
        start: '1',
        end: '2',
      },
      {
        x: 274.66117720170456,
        y: 149.6198064630682,
        time: 1689928710992,
        valid: true,
        start: '2',
        end: '3',
      },
      {
        x: 192.06833718039772,
        y: 46.81269975142045,
        time: 1689928712384,
        valid: true,
        start: '3',
        end: '4',
      },
      {
        x: 42.21361194957387,
        y: 42.12533291903409,
        time: 1689928712835,
        valid: true,
        start: '4',
        end: '5',
      },
      {
        x: 197.11934037642047,
        y: 196.8694513494318,
        time: 1689928713574,
        valid: true,
        start: '5',
        end: '6',
      },
      {
        x: 300.77143998579544,
        y: 71.24327503551136,
        time: 1689928713976,
        valid: true,
        start: '6',
        end: '7',
      },
      {
        x: 329.9024103338068,
        y: 269.83358487215907,
        time: 1689928714595,
        valid: true,
        start: '7',
        end: '8',
      },
      {
        x: 64.9019941850142,
        y: 210.9090909090909,
        time: 1689928715383,
        valid: true,
        start: '8',
        end: '9',
      },
      {
        x: 69.98554576526989,
        y: 277.1715642755682,
        time: 1689928715668,
        valid: false,
        start: '9',
        end: '10',
        actual: '11',
      },
    ],
  },
  {
    points: [
      {
        x: 80.72727272727273,
        y: 283.6363636363636,
        time: 1689928717438,
        valid: true,
        start: '9',
        end: '10',
      },
      {
        x: 177.87673117897728,
        y: 112.28557794744319,
        time: 1689928717779,
        valid: false,
        start: '10',
        end: '11',
        actual: '5',
      },
    ],
  },
  {
    points: [
      {
        x: 183.63636363636363,
        y: 113.0909090909091,
        time: 1689928719171,
        valid: true,
        start: '10',
        end: '11',
      },
    ],
  },
];
const regularResult = [
  {
    UTC_Timestamp: '1689928710.571',
    actual_path: '1 ~ 2',
    correct_path: '1 ~ 2',
    epoch_time_in_seconds_start: '1689928710.571',
    error: 'E0',
    line_number: '0',
    seconds: '0',
    total_number_of_errors: '2',
    total_time: '8.6',
    x: '16.574585635359114',
    y: '62.430939226519335',
  },
  {
    UTC_Timestamp: '1689928710.992',
    actual_path: '2 ~ 3',
    correct_path: '2 ~ 3',
    epoch_time_in_seconds_start: '',
    error: 'E0',
    line_number: '0',
    seconds: '0.421',
    total_number_of_errors: '',
    total_time: '',
    x: '75.87325337063662',
    y: '58.66856175053365',
  },
  {
    UTC_Timestamp: '1689928712.384',
    actual_path: '3 ~ 4',
    correct_path: '3 ~ 4',
    epoch_time_in_seconds_start: '',
    error: 'E0',
    line_number: '0',
    seconds: '1.813',
    total_number_of_errors: '',
    total_time: '',
    x: '53.057551707292184',
    y: '87.06831498579545',
  },
  {
    UTC_Timestamp: '1689928712.835',
    actual_path: '4 ~ 5',
    correct_path: '4 ~ 5',
    epoch_time_in_seconds_start: '',
    error: 'E0',
    line_number: '0',
    seconds: '2.264',
    total_number_of_errors: '',
    total_time: '',
    x: '11.661218770600517',
    y: '88.36316770192428',
  },
  {
    UTC_Timestamp: '1689928713.574',
    actual_path: '5 ~ 6',
    correct_path: '5 ~ 6',
    epoch_time_in_seconds_start: '',
    error: 'E0',
    line_number: '0',
    seconds: '3.003',
    total_number_of_errors: '',
    total_time: '',
    x: '54.45285645757472',
    y: '45.61617366037795',
  },
  {
    UTC_Timestamp: '1689928713.976',
    actual_path: '6 ~ 7',
    correct_path: '6 ~ 7',
    epoch_time_in_seconds_start: '',
    error: 'E0',
    line_number: '0',
    seconds: '3.405',
    total_number_of_errors: '',
    total_time: '',
    x: '83.08603314524736',
    y: '80.31953728300792',
  },
  {
    UTC_Timestamp: '1689928714.595',
    actual_path: '7 ~ 8',
    correct_path: '7 ~ 8',
    epoch_time_in_seconds_start: '',
    error: 'E0',
    line_number: '0',
    seconds: '4.024',
    total_number_of_errors: '',
    total_time: '',
    x: '91.13326252315105',
    y: '25.460335670674297',
  },
  {
    UTC_Timestamp: '1689928715.383',
    actual_path: '8 ~ 9',
    correct_path: '8 ~ 9',
    epoch_time_in_seconds_start: '',
    error: 'E0',
    line_number: '0',
    seconds: '4.812',
    total_number_of_errors: '',
    total_time: '',
    x: '17.928727675418287',
    y: '41.73782019085886',
  },
  {
    UTC_Timestamp: '1689928715.668',
    actual_path: '9 ~ 11',
    correct_path: '9 ~ 10',
    epoch_time_in_seconds_start: '',
    error: 'E1',
    line_number: '0',
    seconds: '5.097',
    total_number_of_errors: '',
    total_time: '',
    x: '19.333023692063506',
    y: '23.433269537135857',
  },
  {
    UTC_Timestamp: '1689928717.438',
    actual_path: '9 ~ 10',
    correct_path: '9 ~ 10',
    epoch_time_in_seconds_start: '',
    error: 'E0',
    line_number: '1',
    seconds: '6.867',
    total_number_of_errors: '',
    total_time: '',
    x: '22.30035158211954',
    y: '21.647413360120552',
  },
  {
    UTC_Timestamp: '1689928717.779',
    actual_path: '10 ~ 5',
    correct_path: '10 ~ 11',
    epoch_time_in_seconds_start: '',
    error: 'E1',
    line_number: '1',
    seconds: '7.208',
    total_number_of_errors: '',
    total_time: '',
    x: '49.13721855772853',
    y: '68.9818845449052',
  },
  {
    UTC_Timestamp: '1689928719.171',
    actual_path: '10 ~ 11',
    correct_path: '10 ~ 11',
    epoch_time_in_seconds_start: '',
    error: 'E0',
    line_number: '2',
    seconds: '8.6',
    total_number_of_errors: '',
    total_time: '',
    x: '50.72827724761426',
    y: '68.7594173782019',
  },
];

describe('getABTrailsRecords', () => {
  test.each`
    lines           | width  | expected         | description
    ${abTrailLines} | ${362} | ${regularResult} | ${'should generate records for width = 300'}
    ${abTrailLines} | ${0}   | ${[]}            | ${'should return empty array for width = 0'}
  `('$description', ({ lines, width, expected }) => {
    expect(getABTrailsRecords(lines, width)).toEqual(expected);
  });
});
